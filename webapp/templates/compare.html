{# This simple template derives from ``base.html``. See ``base.html`` for
more information about template inheritance. #}
{%- extends "base.html" %}

{# Loads some of the macros included with Flask-Bootstrap. We are using the
utils module here to automatically render Flask's flashed messages in a
bootstrap friendly manner #}
{% import "bootstrap/utils.html" as utils %}


{# Inside the ``content`` is where you should place most of your own stuff.
This will keep scripts at the page end and a navbar you add on later
intact. #}

{% block content %}
<div class="container-fluid">
    <div class="row">

        <div class="col-sm-2 col-md-1 sidebar">
            <ul class="nav nav-sidebar">
                <!-- TODO active class via javascript? -->
                <!--<li class="active"><a href="#">Overview <span class="sr-only">(current)</span></a></li>-->
                <li class="active"><a href="#compare">Compare</a></li>
                <li><a href="#explore">Explore</a></li>
            </ul>
            <!--<ul class="nav nav-sidebar">-->
            <!--<li><a href="">Nav item</a></li>-->
            <!--<li><a href="">Nav item again</a></li>-->
            <!--<li><a href="">One more nav</a></li>-->
            <!--<li><a href="">Another nav item</a></li>-->
            <!--<li><a href="">More navigation</a></li>-->
            <!--</ul>-->
        </div>

        <div class="col-sm-10 col-sm-offset-2 col-md-11 col-md-offset-1 main">
        {% if not researcher %}
        {% for error in errors %}
        <div class="alert alert-danger" role="alert">
            <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
            <span class="sr-only">Error:</span>
            {{error}}
        </div>
        {%endfor%}
        {%endif%}



            <!--<div class="row placeholders">-->
            <!--<div class="col-xs-6 col-sm-3 placeholder">-->
            <!--<img src="data:image/gif;base64,R0lGODlhAQABAIAAAHd3dwAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="-->
            <!--width="200" height="200" class="img-responsive" alt="Generic placeholder thumbnail">-->
            <!--<h4>Label</h4>-->
            <!--<span class="text-muted">Something else</span>-->
            <!--</div>-->
            <!--<div class="col-xs-6 col-sm-3 placeholder">-->
            <!--<img src="data:image/gif;base64,R0lGODlhAQABAIAAAHd3dwAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="-->
            <!--width="200" height="200" class="img-responsive" alt="Generic placeholder thumbnail">-->
            <!--<h4>Label</h4>-->
            <!--<span class="text-muted">Something else</span>-->
            <!--</div>-->
            <!--<div class="col-xs-6 col-sm-3 placeholder">-->
            <!--<img src="data:image/gif;base64,R0lGODlhAQABAIAAAHd3dwAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="-->
            <!--width="200" height="200" class="img-responsive" alt="Generic placeholder thumbnail">-->
            <!--<h4>Label</h4>-->
            <!--<span class="text-muted">Something else</span>-->
            <!--</div>-->
            <!--<div class="col-xs-6 col-sm-3 placeholder">-->
            <!--<img src="data:image/gif;base64,R0lGODlhAQABAIAAAHd3dwAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="-->
            <!--width="200" height="200" class="img-responsive" alt="Generic placeholder thumbnail">-->
            <!--<h4>Label</h4>-->
            <!--<span class="text-muted">Something else</span>-->
            <!--</div>-->
            <!--</div>-->
            {% if researcher %}
            <div class="row" id="compare">
                <h2>Comparing for Field
                    <small>{{field_name}}</small>
                </h2>
                <div class="row">
                    <div class="col-sm-6 col-md-4">
                        <div class="thumbnail">
                            <img src="https://scholar.google.de/citations?view_op=view_photo&user={{researcher.id}}&citpid=2"
                                 alt="..." width="150px" height="150px">

                            <div class="caption">
                                <h3>{{researcher.name}}</h3>
                                <ul>
                                    {% for f in researcher.fields_of_study %}
                                    <li><a href="/fos/{{f}}">{{f}}</a></li>
                                    {% endfor %}
                                </ul>

                            </div>
                        </div>
                    </div>
                    <!--<div class="col-sm-6 col-md-4">-->
                    <!--<div class="thumbnail">-->
                    <!--<img src="http://placekitten.com/150/114" alt="...">-->

                    <!--<div class="caption">-->
                    <!--<h3>Average User in Field</h3>-->

                    <!--<ul>-->
                    <!--<li>Chemistry</li>-->
                    <!--<li>Biology</li>-->
                    <!--</ul>-->

                    <!--</div>-->
                    <!--</div>-->
                    <!--</div>-->
                </div>
                <div class="row">
                    <div class="col-sm-12 col-md-8" id="compare_chart">
                        {% if researcher and researcher.measures %}
                        <div id="barchart_material" style="width: 900px; height: 500px;"></div>
                        {% else %}
                        <div class="alert alert-info" role="alert">
                            <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                            <span class="sr-only">Info:</span>
                            {{researcher.name}} currently has no measures attached.
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endif %}
            <div class="row" id="explore">
                <p>Fancy Graph Exploration Stuff from Philipp</p>
            </div>
        </div>
    </div>
</div>
{%- endblock %}

{% block scripts -%}
{{super()}}
{% if researcher and researcher.measures and avg %}
<script type="text/javascript">

    google.load("visualization", "1.1", {packages: ["bar"]});
    google.setOnLoadCallback(drawChart);
    function drawChart() {
        var data = google.visualization.arrayToDataTable([
            ['Person', '0', '1', '2', '3', '4', '5'],
            ['{{researcher.name}}', {{researcher.measures | join(", ")}}],
            ['Avg Researcher In {{field_name}}', {{avg.avg_measures | join(", ") }}]])
        ;

        var options = {
            chart: {
                title: 'Scientific Measurements',
                subtitle: 'Citation indices',
            },
            bars: 'vertical' // Required for Material Bar Charts.
        };

        var chart = new google.charts.Bar(document.getElementById('barchart_material'));

        chart.draw(data, options);
    }
</script>
{% endif %}
{% endblock %}
